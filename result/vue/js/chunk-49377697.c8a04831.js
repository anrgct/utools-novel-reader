(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-49377697"],{"1d79":function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"router",attrs:{id:"read_file"}},[i("el-container",[i("el-header",[i("my-navigation",{attrs:{"active-index":"2"},on:{"created-method":t.created_method,"after-save":t.get_setting_info}})],1),i("el-main",[i("el-form",[i("el-form-item",{attrs:{label:"文件路径"}},[i("el-input",{attrs:{readonly:""},model:{value:t.path,callback:function(e){t.path=e},expression:"path"}}),i("el-button",{on:{click:t.get_file}},[t._v("上传小说文件")])],1),i("el-form-item",{attrs:{label:"作者"}},[i("el-input",{staticStyle:{width:"auto"},model:{value:t.author,callback:function(e){t.author=e},expression:"author"}})],1),i("el-form-item",{attrs:{label:"书名"}},[i("el-input",{staticStyle:{width:"auto"},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}})],1),i("el-form-item",{attrs:{label:"使用正则提取章节"}},[i("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},on:{change:t.whether_regular_changes},model:{value:t.is_regex,callback:function(e){t.is_regex=e},expression:"is_regex"}}),i("el-input",{directives:[{name:"show",rawName:"v-show",value:t.is_regex,expression:"is_regex"}],staticStyle:{width:"auto","margin-left":"20px"},attrs:{placeholder:"正则表达式"},model:{value:t.regex,callback:function(e){t.regex=e},expression:"regex"}}),i("el-input",{directives:[{name:"show",rawName:"v-show",value:!t.is_regex,expression:"!is_regex"}],staticStyle:{width:"auto","margin-left":"20px"},attrs:{placeholder:"章节字符数",type:"number"},model:{value:t.split_num,callback:function(e){t.split_num=e},expression:"split_num"}}),i("el-button",{staticStyle:{"margin-left":"20px"},attrs:{disabled:void 0===t.path},on:{click:t.split_novel}},[t._v("获取章节 ")])],1)],1),i("el-button",{attrs:{disabled:void 0===t.path},on:{click:t.add_bookshelf}},[t._v("加入书架")]),i("div",[i("div",{staticStyle:{"text-align":"center"}},[i("h4",{staticClass:"title"},[t._v("目录")])]),t._l(t.directory_list,(function(e,n){return i("el-col",{key:n,attrs:{span:8}},[i("el-link",{attrs:{target:"_blank",underline:!1}},[t._v(t._s(e.name)+" ")])],1)}))],2)],1)],1)],1)},a=[],s=(i("d81d"),i("b0c0"),i("d3b7"),i("4d63"),i("ac1f"),i("25f0"),i("466d"),i("f11d")),r={name:"read_file",components:{"my-navigation":s["a"]},data:function(){return{content:"",author:"未知",read_chapter:"",directory_list:[],type:"0",regex:"",name:"",is_regex:!1,split_num:4e3,remind:{collect_remind:3,update_reading_section:3,settings_saved_remind:3}}},methods:{created_method:function(){var t=this;window.utools.setSubInput((function(e){var i=e.text;t.$router.push({name:"search",query:{name:i,type:"1"}})}),"搜索在线小说"),window.utools.subInputBlur(),document.onkeydown=void 0,this.get_setting_info(),void 0!==this.path?(window.qs.readFile(this.path,{},(function(e,i){if(e)return t.$notify({title:"错误",message:"读取文件失败，请重新读取文件",duration:0,type:"error"}),t.$router.push({name:"read_file"}),void t.created_method();t.content=" "+i.toString(),t.name=t.path.match(/\\([^\\]*?)\./)[1]})),this.$notify({title:"提示",message:"目前仅支持utf-8编码的.txt结尾的文件,其他编码方式的.txt文件可以通过文本编辑器改成utf-8编码,就可以正确读取",duration:0,type:"info"})):this.$message({showClose:!0,message:"还没读取文件，先读取文件",type:"error"})},add_bookshelf:function(){this.split_novel();var t,e={_id:this.path,content:this.content,read_chapter:this.directory_list[0],type:"0",regex:this.regex,name:this.name,is_regex:this.is_regex,split_num:this.split_num,author:this.author,directory_list:this.directory_list},i=window.utools.db.get(this.path);null===i||(e._rev=i._rev),t=window.utools.db.put(e),t.hasOwnProperty("error")&&t["error"]?this.remind.collect_remind>=2&&this.$notify({title:"错误",message:"加入书架失败",duration:0,type:"error"}):(this.whether_collection=!0,this.remind.collect_remind>=3&&this.$notify({title:"成功",message:"加入书架成功",type:"success"}))},split_novel:function(){if(this.directory_list=[],this.is_regex)if(""!==this.regex){var t=new RegExp(this.regex,"g");this.directory_list=this.content.match(t),this.directory_list=this.directory_list.map((function(t,e){return{name:t,cid:e}}))}else this.$notify({title:"错误",message:"正则表达式不能为空",type:"error"});else{this.directory_list=[];for(var e=this.content.length/this.split_num+(this.content.length%this.split_num!==0),i=0;i<e;i++)this.directory_list.push({name:"第".concat(i+1,"章"),cid:i})}},whether_regular_changes:function(t){t?this.$notify({title:"提示",message:"使用正则表达式分割章节，正则表达式匹配的值将作为章节名",type:"info"}):this.$notify({title:"提示",message:"不使用正则表达式分割章节，可以选择输入框里输入的数字作为每一章的字符数(包括空格和符号),章节名为第*章",type:"info"})},get_file:function(){var t=this;window.dialog.showOpenDialog({title:"获取小说文件",filters:[{name:"txt文档",extensions:["txt"]}],properties:["openFile"]},(function(e){1===e.length?(console.log(e),t.$router.push({name:"read_file",query:{path:e[0]}}),t.created_method()):t.$message({showClose:!0,message:"没有选取文件",type:"error"})}))},get_setting_info:function(){this.remind=window.utools.db.get("setting").remind}},created:function(){this.created_method()},computed:{path:function(){return this.$route.query.path}}},o=r,l=(i("2fb4"),i("2877")),c=Object(l["a"])(o,n,a,!1,null,"10a3ddc8",null);e["default"]=c.exports},"2fb4":function(t,e,i){"use strict";var n=i("de58"),a=i.n(n);a.a},d81d:function(t,e,i){"use strict";var n=i("23e7"),a=i("b727").map,s=i("1dde"),r=i("ae40"),o=s("map"),l=r("map");n({target:"Array",proto:!0,forced:!o||!l},{map:function(t){return a(this,t,arguments.length>1?arguments[1]:void 0)}})},de58:function(t,e,i){},f11d:function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"Navigation"},[i("el-menu",{attrs:{"default-active":t.activeIndex,mode:"horizontal"},on:{select:t.select}},[t._l(t.navigation_item,(function(e,n){return i("el-menu-item",{key:n,attrs:{index:String(n)}},[t._v(t._s(e.name)+" ")])})),i("el-link",{staticStyle:{float:"right",height:"60px"},attrs:{index:"setting",underline:!1},on:{click:function(e){t.dialogVisible=!0}}},[i("i",{staticClass:"el-icon-s-tools",staticStyle:{"font-size":"20px","align-self":"center"}})]),i("el-link",{staticStyle:{float:"right",height:"60px"},attrs:{index:"setting",underline:!1},on:{click:function(e){return t.$emit("created-method")}}},[i("i",{staticClass:"el-icon-refresh-right",staticStyle:{"font-size":"20px","align-self":"center","margin-right":"6px"}})])],2),i("my-setting",{attrs:{"dialog-visible":t.dialogVisible},on:{"close-dialog":function(e){t.dialogVisible=!1},"after-save":function(e){return t.$emit("after-save")}}})],1)},a=[],s=i("f49f"),r={name:"Navigation",components:{"my-setting":s["a"]},data:function(){return{navigation_item:[{name:"搜索",path:{name:"search",query:{type:"1"}}},{name:"书架",path:{name:"bookshelf"}},{name:"读取文件",path:{name:"read_file"}},{name:"测试",path:{name:"text"}}],dialogVisible:!1}},props:{activeIndex:String},methods:{select:function(t){this.$router.push(this.navigation_item[t].path)}}},o=r,l=i("2877"),c=Object(l["a"])(o,n,a,!1,null,"6a269038",null);e["a"]=c.exports}}]);
//# sourceMappingURL=chunk-49377697.c8a04831.js.map